<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>turtlephoto</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #1a1a2e, #16213e, #0f3460);
            color: #fff;
            min-height: 100vh;
            padding: 20px;
            line-height: 1.6;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        header {
            text-align: center;
            margin-bottom: 30px;
            padding: 20px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            border: 2px solid #e63946;
            box-shadow: 0 0 15px rgba(230, 57, 70, 0.3);
        }
        
        h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            color: #e63946;
            text-transform: lowercase;
            text-shadow: 0 0 10px rgba(230, 57, 70, 0.5);
        }
        
        .creator {
            font-size: 1rem;
            color: #a8dadc;
            margin-bottom: 20px;
        }
        
        .main-content {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .upload-section {
            flex: 1;
            min-width: 300px;
            background: rgba(255, 255, 255, 0.1);
            padding: 20px;
            border-radius: 10px;
            border: 2px solid #457b9d;
            box-shadow: 0 0 10px rgba(69, 123, 157, 0.3);
        }
        
        .preview-section {
            flex: 2;
            min-width: 300px;
            background: rgba(255, 255, 255, 0.1);
            padding: 20px;
            border-radius: 10px;
            border: 2px solid #f1faee;
            box-shadow: 0 0 10px rgba(241, 250, 238, 0.3);
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        
        .section-title {
            color: #f1faee;
            margin-bottom: 15px;
            padding-bottom: 5px;
            border-bottom: 2px solid;
        }
        
        .upload-title {
            border-color: #457b9d;
        }
        
        .preview-title {
            border-color: #f1faee;
        }
        
        .controls {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }
        
        .control-group {
            margin-bottom: 15px;
            padding: 10px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 5px;
        }
        
        label {
            display: block;
            margin-bottom: 5px;
            color: #a8dadc;
            font-weight: bold;
        }
        
        input[type="range"] {
            width: 100%;
            background: #457b9d;
            border-radius: 5px;
            height: 6px;
        }
        
        input[type="file"] {
            width: 100%;
            padding: 10px;
            background: rgba(69, 123, 157, 0.3);
            border: 1px solid #457b9d;
            border-radius: 5px;
            color: #f1faee;
            margin: 10px 0;
        }
        
        button {
            color: white;
            border: none;
            padding: 12px 15px;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: bold;
            margin: 5px 0;
        }
        
        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
        }
        
        .filter-btn {
            width: 100%;
            margin-bottom: 10px;
        }
        
        .turtle-filter-btn {
            background: linear-gradient(135deg, #2a9d8f, #1d7874);
            border: 1px solid #2a9d8f;
        }
        
        .turtle-filter-btn:hover {
            background: linear-gradient(135deg, #1d7874, #2a9d8f);
        }
        
        .yellow-filter-btn {
            background: linear-gradient(135deg, #e9c46a, #f4a261);
            border: 1px solid #e9c46a;
        }
        
        .yellow-filter-btn:hover {
            background: linear-gradient(135deg, #f4a261, #e9c46a);
        }
        
        .bw-filter-btn {
            background: linear-gradient(135deg, #6c757d, #495057);
            border: 1px solid #6c757d;
        }
        
        .bw-filter-btn:hover {
            background: linear-gradient(135deg, #495057, #6c757d);
        }
        
        .reset-filter-btn {
            background: linear-gradient(135deg, #e63946, #d90429);
            border: 1px solid #e63946;
        }
        
        .reset-filter-btn:hover {
            background: linear-gradient(135deg, #d90429, #e63946);
        }
        
        .add-turtle-btn {
            background: linear-gradient(135deg, #457b9d, #1d3557);
            border: 1px solid #457b9d;
            width: 100%;
        }
        
        .add-turtle-btn:hover {
            background: linear-gradient(135deg, #1d3557, #457b9d);
        }
        
        .download-btn {
            background: linear-gradient(135deg, #e63946, #d90429);
            padding: 15px 30px;
            font-size: 1.1rem;
            margin-top: 20px;
            border: 1px solid #e63946;
        }
        
        .download-btn:hover {
            background: linear-gradient(135deg, #d90429, #e63946);
        }
        
        #imagePreview {
            max-width: 100%;
            max-height: 500px;
            border: 2px solid #f1faee;
            border-radius: 5px;
            margin-bottom: 20px;
            box-shadow: 0 0 20px rgba(241, 250, 238, 0.2);
            cursor: move;
        }
        
        .turtle-container {
            position: relative;
            display: inline-block;
        }
        
        .instructions {
            background: rgba(255, 255, 255, 0.1);
            padding: 20px;
            border-radius: 10px;
            margin-top: 20px;
            border: 2px solid #a8dadc;
            box-shadow: 0 0 10px rgba(168, 218, 220, 0.3);
        }
        
        .instructions h3 {
            color: #a8dadc;
            margin-bottom: 10px;
            border-bottom: 1px solid #a8dadc;
            padding-bottom: 5px;
        }
        
        .instructions ol {
            margin-left: 20px;
        }
        
        .instructions li {
            margin-bottom: 10px;
            color: #f1faee;
        }
        
        footer {
            text-align: center;
            margin-top: 30px;
            padding: 15px;
            color: #a8dadc;
            font-size: 0.9rem;
            border-top: 1px solid #457b9d;
        }
        
        .color-highlight {
            color: #e63946;
            font-weight: bold;
        }
        
        .filter-description {
            font-size: 0.8rem;
            color: #a8dadc;
            margin-top: 5px;
            font-style: italic;
        }
        
        .drag-hint {
            color: #a8dadc;
            font-size: 0.9rem;
            margin-top: 10px;
            text-align: center;
        }
        
        @media (max-width: 768px) {
            .main-content {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>turtlephoto</h1>
            <div class="creator">—Å–æ–∑–¥–∞—Ç–µ–ª—å: NeTricaban</div>
            <p>–ó–∞–≥—Ä—É–∑–∏—Ç–µ —Ñ–æ—Ç–æ –∏ –¥–æ–±–∞–≤—å—Ç–µ <span class="color-highlight">—á–µ—Ä–µ–ø–∞—Ö</span> —Å —Ä–∞–∑–ª–∏—á–Ω—ã–º–∏ —ç—Ñ—Ñ–µ–∫—Ç–∞–º–∏</p>
        </header>
        
        <div class="main-content">
            <div class="upload-section">
                <h2 class="section-title upload-title">–ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–æ—Ç–æ</h2>
                <input type="file" id="imageUpload" accept="image/*">
                <button class="add-turtle-btn" id="addTurtleBtn">–î–æ–±–∞–≤–∏—Ç—å —á–µ—Ä–µ–ø–∞—Ö—É</button>
                
                <div class="controls">
                    <div class="control-group">
                        <label for="turtleSize">–†–∞–∑–º–µ—Ä —á–µ—Ä–µ–ø–∞—Ö–∏: <span id="turtleSizeValue">150</span>px</label>
                        <input type="range" id="turtleSize" min="50" max="400" value="150">
                    </div>
                    
                    <div class="control-group">
                        <label for="turtleRotation">–ü–æ–≤–æ—Ä–æ—Ç —á–µ—Ä–µ–ø–∞—Ö–∏: <span id="turtleRotationValue">0</span>¬∞</label>
                        <input type="range" id="turtleRotation" min="0" max="360" value="0">
                    </div>
                </div>
                
                <h3 class="section-title upload-title">–§–∏–ª—å—Ç—Ä—ã</h3>
                <button class="filter-btn turtle-filter-btn" id="turtleFilter">–§–∏–ª—å—Ç—Ä –ß–µ—Ä–µ–ø–∞—Ö–∞</button>
                <div class="filter-description">–ó–µ–ª–µ–Ω—ã–π –æ—Ç—Ç–µ–Ω–æ–∫ + –±–ª—é—Ä + —á–µ—Ä–µ–ø–∞—Ö–∏ –ø–æ —É–≥–ª–∞–º</div>
                
                <button class="filter-btn yellow-filter-btn" id="yellowFilter">–ñ–µ–ª—Ç—ã–π —Ñ–∏–ª—å—Ç—Ä (Eminem)</button>
                <button class="filter-btn bw-filter-btn" id="bwFilter">–ß–µ—Ä–Ω–æ-–±–µ–ª—ã–π</button>
                <button class="filter-btn reset-filter-btn" id="resetFilter">–°–±—Ä–æ—Å–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä—ã</button>
                
                <h3 class="section-title upload-title">–≠—Ñ—Ñ–µ–∫—Ç—ã</h3>
                <div class="controls">
                    <div class="control-group">
                        <label for="brightness">–Ø—Ä–∫–æ—Å—Ç—å: <span id="brightnessValue">100</span>%</label>
                        <input type="range" id="brightness" min="0" max="200" value="100">
                    </div>
                    
                    <div class="control-group">
                        <label for="contrast">–ö–æ–Ω—Ç—Ä–∞—Å—Ç: <span id="contrastValue">100</span>%</label>
                        <input type="range" id="contrast" min="0" max="200" value="100">
                    </div>
                    
                    <div class="control-group">
                        <label for="saturation">–ù–∞—Å—ã—â–µ–Ω–Ω–æ—Å—Ç—å: <span id="saturationValue">100</span>%</label>
                        <input type="range" id="saturation" min="0" max="200" value="100">
                    </div>
                    
                    <div class="control-group">
                        <label for="blur">–ë–ª—é—Ä: <span id="blurValue">0</span>px</label>
                        <input type="range" id="blur" min="0" max="10" value="0" step="0.1">
                    </div>
                </div>
            </div>
            
            <div class="preview-section">
                <h2 class="section-title preview-title">–ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä</h2>
                <div class="turtle-container">
                    <canvas id="imagePreview"></canvas>
                </div>
                <div class="drag-hint">üí° –ü–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–π—Ç–µ —á–µ—Ä–µ–ø–∞—Ö –º—ã—à–∫–æ–π –¥–ª—è –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏—è</div>
                <button class="download-btn" id="downloadBtn">–°–∫–∞—á–∞—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ</button>
            </div>
        </div>
        
        <div class="instructions">
            <h3>–ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:</h3>
            <ol>
                <li>–ó–∞–≥—Ä—É–∑–∏—Ç–µ —Ñ–æ—Ç–æ —Å –ø–æ–º–æ—â—å—é –∫–Ω–æ–ø–∫–∏ "–í—ã–±–µ—Ä–∏—Ç–µ —Ñ–∞–π–ª"</li>
                <li>–ù–∞–∂–º–∏—Ç–µ "–î–æ–±–∞–≤–∏—Ç—å —á–µ—Ä–µ–ø–∞—Ö—É" —á—Ç–æ–±—ã —Ä–∞–∑–º–µ—Å—Ç–∏—Ç—å —á–µ—Ä–µ–ø–∞—Ö—É –Ω–∞ —Ñ–æ—Ç–æ</li>
                <li>–ü–µ—Ä–µ—Ç–∞—â–∏—Ç–µ —á–µ—Ä–µ–ø–∞—Ö—É –≤ –Ω—É–∂–Ω–æ–µ –º–µ—Å—Ç–æ (—É–¥–µ—Ä–∂–∏–≤–∞–π—Ç–µ –∏ –ø–µ—Ä–µ–º–µ—â–∞–π—Ç–µ –º—ã—à–∫–æ–π)</li>
                <li>–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ñ–∏–ª—å—Ç—Ä—ã –∏ —ç—Ñ—Ñ–µ–∫—Ç—ã –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤–Ω–µ—à–Ω–µ–≥–æ –≤–∏–¥–∞ —Ñ–æ—Ç–æ</li>
                <li>–ù–∞–∂–º–∏—Ç–µ "–°–∫–∞—á–∞—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ" —á—Ç–æ–±—ã —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç</li>
            </ol>
        </div>
        
        <footer>
            <p>turtlephoto &copy; 2025 | –°–æ–∑–¥–∞–Ω–æ NeTricaban</p>
        </footer>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const imageUpload = document.getElementById('imageUpload');
            const imagePreview = document.getElementById('imagePreview');
            const addTurtleBtn = document.getElementById('addTurtleBtn');
            const turtleSize = document.getElementById('turtleSize');
            const turtleRotation = document.getElementById('turtleRotation');
            const turtleFilter = document.getElementById('turtleFilter');
            const yellowFilter = document.getElementById('yellowFilter');
            const bwFilter = document.getElementById('bwFilter');
            const resetFilter = document.getElementById('resetFilter');
            const brightness = document.getElementById('brightness');
            const contrast = document.getElementById('contrast');
            const saturation = document.getElementById('saturation');
            const blur = document.getElementById('blur');
            const downloadBtn = document.getElementById('downloadBtn');
            
            // –≠–ª–µ–º–µ–Ω—Ç—ã –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –∑–Ω–∞—á–µ–Ω–∏–π
            const turtleSizeValue = document.getElementById('turtleSizeValue');
            const turtleRotationValue = document.getElementById('turtleRotationValue');
            const brightnessValue = document.getElementById('brightnessValue');
            const contrastValue = document.getElementById('contrastValue');
            const saturationValue = document.getElementById('saturationValue');
            const blurValue = document.getElementById('blurValue');
            
            const ctx = imagePreview.getContext('2d');
            let originalImage = null;
            let turtles = [];
            let activeTurtle = null;
            let offsetX, offsetY;
            let cornerTurtles = [];
            let isDragging = false;
            
            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏–π –ø–æ–ª–∑—É–Ω–∫–æ–≤
            turtleSize.addEventListener('input', function() {
                turtleSizeValue.textContent = this.value;
                if (activeTurtle) {
                    activeTurtle.size = parseInt(this.value);
                    drawImage();
                }
            });
            
            turtleRotation.addEventListener('input', function() {
                turtleRotationValue.textContent = this.value;
                if (activeTurtle) {
                    activeTurtle.rotation = parseInt(this.value);
                    drawImage();
                }
            });
            
            brightness.addEventListener('input', function() {
                brightnessValue.textContent = this.value;
                drawImage();
            });
            
            contrast.addEventListener('input', function() {
                contrastValue.textContent = this.value;
                drawImage();
            });
            
            saturation.addEventListener('input', function() {
                saturationValue.textContent = this.value;
                drawImage();
            });
            
            blur.addEventListener('input', function() {
                blurValue.textContent = this.value;
                drawImage();
            });
            
            // –ó–∞–≥—Ä—É–∑–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
            imageUpload.addEventListener('change', function(e) {
                const file = e.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = function(event) {
                        const img = new Image();
                        img.onload = function() {
                            // –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä –¥–ª—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
                            const maxWidth = 800;
                            const maxHeight = 600;
                            let width = img.width;
                            let height = img.height;
                            
                            if (width > maxWidth) {
                                height = (maxWidth / width) * height;
                                width = maxWidth;
                            }
                            
                            if (height > maxHeight) {
                                width = (maxHeight / height) * width;
                                height = maxHeight;
                            }
                            
                            imagePreview.width = width;
                            imagePreview.height = height;
                            originalImage = img;
                            turtles = [];
                            cornerTurtles = [];
                            drawImage();
                        };
                        img.src = event.target.result;
                    };
                    reader.readAsDataURL(file);
                }
            });
            
            // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —á–µ—Ä–µ–ø–∞—Ö–∏
            addTurtleBtn.addEventListener('click', function() {
                if (!originalImage) {
                    alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, —Å–Ω–∞—á–∞–ª–∞ –∑–∞–≥—Ä—É–∑–∏—Ç–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ');
                    return;
                }
                
                const turtle = {
                    x: imagePreview.width / 2 - parseInt(turtleSize.value)/2,
                    y: imagePreview.height / 2 - parseInt(turtleSize.value)/2,
                    size: parseInt(turtleSize.value),
                    rotation: parseInt(turtleRotation.value),
                    image: new Image()
                };
                
                turtle.image.onload = function() {
                    turtles.push(turtle);
                    drawImage();
                };
                
                turtle.image.src = 'https://png.pngtree.com/png-clipart/20231001/original/pngtree-red-eared-brazilian-slider-turtle-trachemys-scripta-isolated-png-image_13025113.png';
            });
            
            // –§–∏–ª—å—Ç—Ä—ã
            turtleFilter.addEventListener('click', function() {
                applyTurtleFilter();
            });
            
            yellowFilter.addEventListener('click', function() {
                applyYellowFilter();
            });
            
            bwFilter.addEventListener('click', function() {
                applyBWFilter();
            });
            
            resetFilter.addEventListener('click', function() {
                resetFilters();
            });
            
            // –°–∫–∞—á–∏–≤–∞–Ω–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
            downloadBtn.addEventListener('click', function() {
                if (!originalImage) {
                    alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, —Å–Ω–∞—á–∞–ª–∞ –∑–∞–≥—Ä—É–∑–∏—Ç–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ');
                    return;
                }
                
                // –°–æ–∑–¥–∞–µ–º –≤—Ä–µ–º–µ–Ω–Ω—ã–π canvas –¥–ª—è —Å–∫–∞—á–∏–≤–∞–Ω–∏—è
                const tempCanvas = document.createElement('canvas');
                const tempCtx = tempCanvas.getContext('2d');
                
                tempCanvas.width = imagePreview.width;
                tempCanvas.height = imagePreview.height;
                
                // –û—Ç—Ä–∏—Å–æ–≤—ã–≤–∞–µ–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å —Ñ–∏–ª—å—Ç—Ä–∞–º–∏
                tempCtx.filter = getFilterString();
                tempCtx.drawImage(originalImage, 0, 0, tempCanvas.width, tempCanvas.height);
                
                // –û—Ç—Ä–∏—Å–æ–≤—ã–≤–∞–µ–º –æ–±—ã—á–Ω—ã–µ —á–µ—Ä–µ–ø–∞—Ö–∏
                turtles.forEach(turtle => {
                    tempCtx.save();
                    tempCtx.translate(turtle.x + turtle.size/2, turtle.y + turtle.size/2);
                    tempCtx.rotate(turtle.rotation * Math.PI / 180);
                    tempCtx.drawImage(turtle.image, -turtle.size/2, -turtle.size/2, turtle.size, turtle.size);
                    tempCtx.restore();
                });
                
                // –û—Ç—Ä–∏—Å–æ–≤—ã–≤–∞–µ–º —á–µ—Ä–µ–ø–∞—Ö –ø–æ —É–≥–ª–∞–º (–¥–ª—è —Ñ–∏–ª—å—Ç—Ä–∞)
                cornerTurtles.forEach(turtle => {
                    tempCtx.save();
                    tempCtx.translate(turtle.x + turtle.size/2, turtle.y + turtle.size/2);
                    tempCtx.rotate(turtle.rotation * Math.PI / 180);
                    tempCtx.drawImage(turtle.image, -turtle.size/2, -turtle.size/2, turtle.size, turtle.size);
                    tempCtx.restore();
                });
                
                // –°–æ–∑–¥–∞–µ–º —Å—Å—ã–ª–∫—É –¥–ª—è —Å–∫–∞—á–∏–≤–∞–Ω–∏—è
                const link = document.createElement('a');
                link.download = 'turtlephoto_' + Date.now() + '.png';
                link.href = tempCanvas.toDataURL('image/png');
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
            });
            
            // –û—Ç—Ä–∏—Å–æ–≤–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å —á–µ—Ä–µ–ø–∞—Ö–∞–º–∏ –∏ —ç—Ñ—Ñ–µ–∫—Ç–∞–º–∏
            function drawImage() {
                if (!originalImage) return;
                
                ctx.clearRect(0, 0, imagePreview.width, imagePreview.height);
                ctx.filter = getFilterString();
                ctx.drawImage(originalImage, 0, 0, imagePreview.width, imagePreview.height);
                
                // –û—Ç—Ä–∏—Å–æ–≤–∫–∞ –æ–±—ã—á–Ω—ã—Ö —á–µ—Ä–µ–ø–∞—Ö
                turtles.forEach(turtle => {
                    ctx.save();
                    ctx.translate(turtle.x + turtle.size/2, turtle.y + turtle.size/2);
                    ctx.rotate(turtle.rotation * Math.PI / 180);
                    ctx.drawImage(turtle.image, -turtle.size/2, -turtle.size/2, turtle.size, turtle.size);
                    ctx.restore();
                });
                
                // –û—Ç—Ä–∏—Å–æ–≤–∫–∞ —á–µ—Ä–µ–ø–∞—Ö –ø–æ —É–≥–ª–∞–º (–¥–ª—è —Ñ–∏–ª—å—Ç—Ä–∞)
                cornerTurtles.forEach(turtle => {
                    ctx.save();
                    ctx.translate(turtle.x + turtle.size/2, turtle.y + turtle.size/2);
                    ctx.rotate(turtle.rotation * Math.PI / 180);
                    ctx.drawImage(turtle.image, -turtle.size/2, -turtle.size/2, turtle.size, turtle.size);
                    ctx.restore();
                });
            }
            
            // –ü–æ–ª—É—á–µ–Ω–∏–µ —Å—Ç—Ä–æ–∫–∏ —Ñ–∏–ª—å—Ç—Ä–∞ –¥–ª—è canvas
            function getFilterString() {
                const brightnessVal = parseInt(brightness.value);
                const contrastVal = parseInt(contrast.value);
                const saturationVal = parseInt(saturation.value);
                const blurVal = parseFloat(blur.value);
                
                return `brightness(${brightnessVal}%) contrast(${contrastVal}%) saturate(${saturationVal}%) blur(${blurVal}px)`;
            }
            
            // –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ —Ñ–∏–ª—å—Ç—Ä–∞ —á–µ—Ä–µ–ø–∞—Ö–∏
            function applyTurtleFilter() {
                brightness.value = 95;
                brightnessValue.textContent = '95';
                contrast.value = 110;
                contrastValue.textContent = '110';
                saturation.value = 120;
                saturationValue.textContent = '120';
                blur.value = 1.5;
                blurValue.textContent = '1.5';
                
                // –î–æ–±–∞–≤–ª—è–µ–º —á–µ—Ä–µ–ø–∞—Ö –ø–æ —É–≥–ª–∞–º
                cornerTurtles = [];
                const turtleSize = 80;
                
                // –õ–µ–≤—ã–π –≤–µ—Ä—Ö–Ω–∏–π —É–≥–æ–ª
                cornerTurtles.push({
                    x: 10,
                    y: 10,
                    size: turtleSize,
                    rotation: 45,
                    image: new Image()
                });
                
                // –ü—Ä–∞–≤—ã–π –≤–µ—Ä—Ö–Ω–∏–π —É–≥–æ–ª
                cornerTurtles.push({
                    x: imagePreview.width - turtleSize - 10,
                    y: 10,
                    size: turtleSize,
                    rotation: -45,
                    image: new Image()
                });
                
                // –õ–µ–≤—ã–π –Ω–∏–∂–Ω–∏–π —É–≥–æ–ª
                cornerTurtles.push({
                    x: 10,
                    y: imagePreview.height - turtleSize - 10,
                    size: turtleSize,
                    rotation: 135,
                    image: new Image()
                });
                
                // –ü—Ä–∞–≤—ã–π –Ω–∏–∂–Ω–∏–π —É–≥–æ–ª
                cornerTurtles.push({
                    x: imagePreview.width - turtleSize - 10,
                    y: imagePreview.height - turtleSize - 10,
                    size: turtleSize,
                    rotation: -135,
                    image: new Image()
                });
                
                // –ó–∞–≥—Ä—É–∂–∞–µ–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è —á–µ—Ä–µ–ø–∞—Ö
                cornerTurtles.forEach(turtle => {
                    turtle.image.onload = function() {
                        drawImage();
                    };
                    turtle.image.src = 'https://png.pngtree.com/png-clipart/20231001/original/pngtree-red-eared-brazilian-slider-turtle-trachemys-scripta-isolated-png-image_13025113.png';
                });
                
                drawImage();
            }
            
            // –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –∂–µ–ª—Ç–æ–≥–æ —Ñ–∏–ª—å—Ç—Ä–∞ (Eminem)
            function applyYellowFilter() {
                brightness.value = 110;
                brightnessValue.textContent = '110';
                contrast.value = 120;
                contrastValue.textContent = '120';
                saturation.value = 130;
                saturationValue.textContent = '130';
                blur.value = 0;
                blurValue.textContent = '0';
                cornerTurtles = [];
                drawImage();
            }
            
            // –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ —á–µ—Ä–Ω–æ-–±–µ–ª–æ–≥–æ —Ñ–∏–ª—å—Ç—Ä–∞
            function applyBWFilter() {
                brightness.value = 100;
                brightnessValue.textContent = '100';
                contrast.value = 120;
                contrastValue.textContent = '120';
                saturation.value = 0;
                saturationValue.textContent = '0';
                blur.value = 0;
                blurValue.textContent = '0';
                cornerTurtles = [];
                drawImage();
            }
            
            // –°–±—Ä–æ—Å —Ñ–∏–ª—å—Ç—Ä–æ–≤
            function resetFilters() {
                brightness.value = 100;
                brightnessValue.textContent = '100';
                contrast.value = 100;
                contrastValue.textContent = '100';
                saturation.value = 100;
                saturationValue.textContent = '100';
                blur.value = 0;
                blurValue.textContent = '0';
                cornerTurtles = [];
                drawImage();
            }
            
            // –ü–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–Ω–∏–µ —á–µ—Ä–µ–ø–∞—Ö
            imagePreview.addEventListener('mousedown', startDrag);
            imagePreview.addEventListener('touchstart', startDragTouch);
            
            function startDrag(e) {
                e.preventDefault();
                const rect = imagePreview.getBoundingClientRect();
                const x = e.clientX - rect.left;
                const y = e.clientY - rect.top;
                handleDragStart(x, y);
            }
            
            function startDragTouch(e) {
                e.preventDefault();
                const rect = imagePreview.getBoundingClientRect();
                const touch = e.touches[0];
                const x = touch.clientX - rect.left;
                const y = touch.clientY - rect.top;
                handleDragStart(x, y);
            }
            
            function handleDragStart(x, y) {
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –±—ã–ª–∞ –ª–∏ –Ω–∞–∂–∞—Ç–∞ —á–µ—Ä–µ–ø–∞—Ö–∞
                for (let i = turtles.length - 1; i >= 0; i--) {
                    const turtle = turtles[i];
                    
                    // –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–ø–∞–¥–∞–Ω–∏—è –≤ –æ–±–ª–∞—Å—Ç—å —á–µ—Ä–µ–ø–∞—Ö–∏
                    if (x >= turtle.x && x <= turtle.x + turtle.size && 
                        y >= turtle.y && y <= turtle.y + turtle.size) {
                        activeTurtle = turtle;
                        offsetX = x - turtle.x;
                        offsetY = y - turtle.y;
                        isDragging = true;
                        imagePreview.style.cursor = 'grabbing';
                        break;
                    }
                }
            }
            
            document.addEventListener('mousemove', drag);
            document.addEventListener('touchmove', dragTouch);
            
            function drag(e) {
                if (!isDragging || !activeTurtle) return;
                e.preventDefault();
                const rect = imagePreview.getBoundingClientRect();
                const x = e.clientX - rect.left;
                const y = e.clientY - rect.top;
                handleDrag(x, y);
            }
            
            function dragTouch(e) {
                if (!isDragging || !activeTurtle) return;
                e.preventDefault();
                const rect = imagePreview.getBoundingClientRect();
                const touch = e.touches[0];
                const x = touch.clientX - rect.left;
                const y = touch.clientY - rect.top;
                handleDrag(x, y);
            }
            
            function handleDrag(x, y) {
                activeTurtle.x = x - offsetX;
                activeTurtle.y = y - offsetY;
                
                // –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏—è –≤ –ø—Ä–µ–¥–µ–ª–∞—Ö canvas
                activeTurtle.x = Math.max(0, Math.min(imagePreview.width - activeTurtle.size, activeTurtle.x));
                activeTurtle.y = Math.max(0, Math.min(imagePreview.height - activeTurtle.size, activeTurtle.y));
                
                drawImage();
            }
            
            document.addEventListener('mouseup', stopDrag);
            document.addEventListener('touchend', stopDrag);
            
            function stopDrag() {
                if (isDragging) {
                    isDragging = false;
                    activeTurtle = null;
                    imagePreview.style.cursor = 'default';
                }
            }
        });
    </script>
</body>
</html>
