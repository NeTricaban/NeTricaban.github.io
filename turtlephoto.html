<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>turtlephoto</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #1a1a2e, #16213e, #0f3460);
            color: #fff;
            min-height: 100vh;
            padding: 20px;
            line-height: 1.6;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        header {
            text-align: center;
            margin-bottom: 30px;
            padding: 20px;
            background: rgba(0, 0, 0, 0.5);
            border-radius: 10px;
            border: 1px solid #00b4d8;
        }
        
        h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            color: #00b4d8;
            text-transform: lowercase;
        }
        
        .creator {
            font-size: 1rem;
            color: #90e0ef;
            margin-bottom: 20px;
        }
        
        .main-content {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .upload-section {
            flex: 1;
            min-width: 300px;
            background: rgba(0, 0, 0, 0.5);
            padding: 20px;
            border-radius: 10px;
            border: 1px solid #00b4d8;
        }
        
        .preview-section {
            flex: 2;
            min-width: 300px;
            background: rgba(0, 0, 0, 0.5);
            padding: 20px;
            border-radius: 10px;
            border: 1px solid #00b4d8;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        
        .controls {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }
        
        .control-group {
            margin-bottom: 15px;
        }
        
        label {
            display: block;
            margin-bottom: 5px;
            color: #90e0ef;
        }
        
        input[type="range"] {
            width: 100%;
        }
        
        button {
            background: #00b4d8;
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 5px;
            cursor: pointer;
            transition: background 0.3s;
            font-weight: bold;
        }
        
        button:hover {
            background: #0077b6;
        }
        
        .filter-btn {
            width: 100%;
            margin-bottom: 10px;
        }
        
        #imagePreview {
            max-width: 100%;
            max-height: 400px;
            border: 2px solid #00b4d8;
            border-radius: 5px;
            margin-bottom: 20px;
        }
        
        .turtle-container {
            position: relative;
            display: inline-block;
        }
        
        .turtle {
            position: absolute;
            width: 80px;
            height: auto;
            cursor: move;
            z-index: 10;
        }
        
        .download-btn {
            background: #4cc9f0;
            padding: 12px 25px;
            font-size: 1.1rem;
            margin-top: 20px;
        }
        
        .instructions {
            background: rgba(0, 0, 0, 0.5);
            padding: 20px;
            border-radius: 10px;
            margin-top: 20px;
            border: 1px solid #00b4d8;
        }
        
        .instructions h3 {
            color: #00b4d8;
            margin-bottom: 10px;
        }
        
        .instructions ol {
            margin-left: 20px;
        }
        
        .instructions li {
            margin-bottom: 10px;
        }
        
        footer {
            text-align: center;
            margin-top: 30px;
            padding: 15px;
            color: #90e0ef;
            font-size: 0.9rem;
        }
        
        @media (max-width: 768px) {
            .main-content {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>turtlephoto</h1>
            <div class="creator">создатель: NeTricaban</div>
            <p>Загрузите фото и добавьте черепах с различными эффектами</p>
        </header>
        
        <div class="main-content">
            <div class="upload-section">
                <h2>Загрузка фото</h2>
                <input type="file" id="imageUpload" accept="image/*" style="margin: 15px 0; display: block; width: 100%;">
                <button id="addTurtleBtn">Добавить черепаху</button>
                
                <div class="controls">
                    <div class="control-group">
                        <label for="turtleSize">Размер черепахи:</label>
                        <input type="range" id="turtleSize" min="20" max="200" value="80">
                    </div>
                    
                    <div class="control-group">
                        <label for="turtleRotation">Поворот черепахи:</label>
                        <input type="range" id="turtleRotation" min="0" max="360" value="0">
                    </div>
                </div>
                
                <h3 style="margin-top: 20px;">Фильтры</h3>
                <button class="filter-btn" id="yellowFilter">Желтый фильтр (Eminem)</button>
                <button class="filter-btn" id="bwFilter">Черно-белый</button>
                <button class="filter-btn" id="resetFilter">Сбросить фильтры</button>
                
                <h3 style="margin-top: 20px;">Эффекты</h3>
                <div class="controls">
                    <div class="control-group">
                        <label for="brightness">Яркость:</label>
                        <input type="range" id="brightness" min="0" max="200" value="100">
                    </div>
                    
                    <div class="control-group">
                        <label for="contrast">Контраст:</label>
                        <input type="range" id="contrast" min="0" max="200" value="100">
                    </div>
                    
                    <div class="control-group">
                        <label for="saturation">Насыщенность:</label>
                        <input type="range" id="saturation" min="0" max="200" value="100">
                    </div>
                </div>
            </div>
            
            <div class="preview-section">
                <h2>Предпросмотр</h2>
                <div class="turtle-container">
                    <canvas id="imagePreview"></canvas>
                </div>
                <button class="download-btn" id="downloadBtn">Скачать изображение</button>
            </div>
        </div>
        
        <div class="instructions">
            <h3>Как использовать:</h3>
            <ol>
                <li>Загрузите фото с помощью кнопки "Выберите файл"</li>
                <li>Нажмите "Добавить черепаху" чтобы разместить черепаху на фото</li>
                <li>Перетащите черепаху в нужное место</li>
                <li>Используйте фильтры и эффекты для изменения внешнего вида фото</li>
                <li>Нажмите "Скачать изображение" чтобы сохранить результат</li>
            </ol>
        </div>
        
        <footer>
            <p>turtlephoto &copy; 2023 | Создано NeTricaban</p>
        </footer>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const imageUpload = document.getElementById('imageUpload');
            const imagePreview = document.getElementById('imagePreview');
            const addTurtleBtn = document.getElementById('addTurtleBtn');
            const turtleSize = document.getElementById('turtleSize');
            const turtleRotation = document.getElementById('turtleRotation');
            const yellowFilter = document.getElementById('yellowFilter');
            const bwFilter = document.getElementById('bwFilter');
            const resetFilter = document.getElementById('resetFilter');
            const brightness = document.getElementById('brightness');
            const contrast = document.getElementById('contrast');
            const saturation = document.getElementById('saturation');
            const downloadBtn = document.getElementById('downloadBtn');
            
            const ctx = imagePreview.getContext('2d');
            let originalImage = null;
            let turtles = [];
            let activeTurtle = null;
            let offsetX, offsetY;
            
            // Загрузка изображения
            imageUpload.addEventListener('change', function(e) {
                const file = e.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = function(event) {
                        const img = new Image();
                        img.onload = function() {
                            imagePreview.width = img.width;
                            imagePreview.height = img.height;
                            originalImage = img;
                            drawImage();
                        };
                        img.src = event.target.result;
                    };
                    reader.readAsDataURL(file);
                }
            });
            
            // Добавление черепахи
            addTurtleBtn.addEventListener('click', function() {
                if (!originalImage) {
                    alert('Пожалуйста, сначала загрузите изображение');
                    return;
                }
                
                const turtle = {
                    x: imagePreview.width / 2 - 40,
                    y: imagePreview.height / 2 - 40,
                    size: parseInt(turtleSize.value),
                    rotation: parseInt(turtleRotation.value),
                    image: new Image()
                };
                
                turtle.image.onload = function() {
                    turtles.push(turtle);
                    drawImage();
                };
                
                turtle.image.src = 'https://png.pngtree.com/png-clipart/20231001/original/pngtree-red-eared-brazilian-slider-turtle-trachemys-scripta-isolated-png-image_13025113.png';
            });
            
            // Изменение размера черепахи
            turtleSize.addEventListener('input', function() {
                if (activeTurtle) {
                    activeTurtle.size = parseInt(this.value);
                    drawImage();
                }
            });
            
            // Изменение поворота черепахи
            turtleRotation.addEventListener('input', function() {
                if (activeTurtle) {
                    activeTurtle.rotation = parseInt(this.value);
                    drawImage();
                }
            });
            
            // Фильтры
            yellowFilter.addEventListener('click', function() {
                applyYellowFilter();
            });
            
            bwFilter.addEventListener('click', function() {
                applyBWFilter();
            });
            
            resetFilter.addEventListener('click', function() {
                resetFilters();
            });
            
            // Эффекты
            brightness.addEventListener('input', drawImage);
            contrast.addEventListener('input', drawImage);
            saturation.addEventListener('input', drawImage);
            
            // Скачивание изображения
            downloadBtn.addEventListener('click', function() {
                if (!originalImage) {
                    alert('Пожалуйста, сначала загрузите изображение');
                    return;
                }
                
                const link = document.createElement('a');
                link.download = 'turtlephoto.png';
                link.href = imagePreview.toDataURL('image/png');
                link.click();
            });
            
            // Отрисовка изображения с черепахами и эффектами
            function drawImage() {
                if (!originalImage) return;
                
                ctx.clearRect(0, 0, imagePreview.width, imagePreview.height);
                ctx.filter = getFilterString();
                ctx.drawImage(originalImage, 0, 0, imagePreview.width, imagePreview.height);
                
                // Отрисовка черепах
                turtles.forEach(turtle => {
                    ctx.save();
                    ctx.translate(turtle.x + turtle.size/2, turtle.y + turtle.size/2);
                    ctx.rotate(turtle.rotation * Math.PI / 180);
                    ctx.drawImage(turtle.image, -turtle.size/2, -turtle.size/2, turtle.size, turtle.size);
                    ctx.restore();
                });
            }
            
            // Получение строки фильтра для canvas
            function getFilterString() {
                const brightnessVal = parseInt(brightness.value);
                const contrastVal = parseInt(contrast.value);
                const saturationVal = parseInt(saturation.value);
                
                return `brightness(${brightnessVal}%) contrast(${contrastVal}%) saturate(${saturationVal}%)`;
            }
            
            // Применение желтого фильтра (Eminem)
            function applyYellowFilter() {
                brightness.value = 110;
                contrast.value = 120;
                saturation.value = 130;
                drawImage();
            }
            
            // Применение черно-белого фильтра
            function applyBWFilter() {
                brightness.value = 100;
                contrast.value = 120;
                saturation.value = 0;
                drawImage();
            }
            
            // Сброс фильтров
            function resetFilters() {
                brightness.value = 100;
                contrast.value = 100;
                saturation.value = 100;
                drawImage();
            }
            
            // Перетаскивание черепах
            imagePreview.addEventListener('mousedown', startDrag);
            
            function startDrag(e) {
                const rect = imagePreview.getBoundingClientRect();
                const x = e.clientX - rect.left;
                const y = e.clientY - rect.top;
                
                // Проверяем, была ли нажата черепаха
                for (let i = turtles.length - 1; i >= 0; i--) {
                    const turtle = turtles[i];
                    const halfSize = turtle.size / 2;
                    const centerX = turtle.x + halfSize;
                    const centerY = turtle.y + halfSize;
                    
                    // Простая проверка попадания в квадрат черепахи
                    if (x >= turtle.x && x <= turtle.x + turtle.size && 
                        y >= turtle.y && y <= turtle.y + turtle.size) {
                        activeTurtle = turtle;
                        offsetX = x - turtle.x;
                        offsetY = y - turtle.y;
                        imagePreview.style.cursor = 'grabbing';
                        break;
                    }
                }
            }
            
            document.addEventListener('mousemove', drag);
            document.addEventListener('mouseup', stopDrag);
            
            function drag(e) {
                if (activeTurtle) {
                    const rect = imagePreview.getBoundingClientRect();
                    const x = e.clientX - rect.left;
                    const y = e.clientY - rect.top;
                    
                    activeTurtle.x = x - offsetX;
                    activeTurtle.y = y - offsetY;
                    
                    // Ограничение перемещения в пределах canvas
                    activeTurtle.x = Math.max(0, Math.min(imagePreview.width - activeTurtle.size, activeTurtle.x));
                    activeTurtle.y = Math.max(0, Math.min(imagePreview.height - activeTurtle.size, activeTurtle.y));
                    
                    drawImage();
                }
            }
            
            function stopDrag() {
                if (activeTurtle) {
                    activeTurtle = null;
                    imagePreview.style.cursor = 'default';
                }
            }
        });
    </script>
</body>
</html>
