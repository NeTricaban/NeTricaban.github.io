<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TurtleBlocks - –í–∏–∑—É–∞–ª—å–Ω–æ–µ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background: linear-gradient(135deg, #1a2a6c, #b21f1f, #fdbb2d);
            color: #fff;
            min-height: 100vh;
            overflow-x: hidden;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 0;
            border-bottom: 2px solid rgba(255, 255, 255, 0.2);
            margin-bottom: 20px;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .logo img {
            width: 60px;
            height: 60px;
        }

        .logo h1 {
            font-size: 2.5rem;
            font-weight: 700;
            background: linear-gradient(90deg, #ff7e5f, #feb47b);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        }

        .help-btn {
            background: rgba(255, 255, 255, 0.2);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .help-btn:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: translateY(-2px);
        }

        .main-content {
            display: grid;
            grid-template-columns: 250px 1fr 300px;
            gap: 20px;
            height: calc(100vh - 150px);
        }

        .categories {
            background: rgba(0, 0, 0, 0.4);
            border-radius: 15px;
            padding: 15px;
            overflow-y: auto;
        }

        .category {
            margin-bottom: 20px;
        }

        .category h3 {
            padding: 10px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            margin-bottom: 10px;
            font-size: 1.1rem;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .blocks-container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
            gap: 10px;
        }

        .block {
            background: rgba(255, 255, 255, 0.15);
            border-radius: 8px;
            padding: 10px;
            cursor: grab;
            transition: all 0.2s;
            text-align: center;
            font-size: 0.9rem;
            border: 1px solid rgba(255, 255, 255, 0.2);
            user-select: none;
        }

        .block:hover {
            background: rgba(255, 255, 255, 0.25);
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }

        .workspace {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 15px;
            padding: 15px;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        .stage-container {
            flex: 1;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            position: relative;
            overflow: hidden;
            margin-bottom: 15px;
        }

        #stage {
            width: 100%;
            height: 100%;
            background: #fff;
            border-radius: 8px;
        }

        .code-area {
            background: rgba(0, 0, 0, 0.4);
            border-radius: 10px;
            padding: 15px;
            height: 200px;
            overflow-y: auto;
            min-height: 200px;
        }

        .code-line {
            background: rgba(255, 255, 255, 0.1);
            margin: 8px 0;
            padding: 10px;
            border-radius: 6px;
            display: flex;
            align-items: center;
            gap: 10px;
            cursor: move;
            user-select: none;
        }

        .code-line.dragging {
            opacity: 0.5;
        }

        .properties {
            background: rgba(0, 0, 0, 0.4);
            border-radius: 15px;
            padding: 15px;
            overflow-y: auto;
        }

        .property-group {
            margin-bottom: 20px;
        }

        .property-group h3 {
            margin-bottom: 10px;
            font-size: 1.1rem;
            color: #ffcc00;
        }

        .property {
            margin-bottom: 10px;
            display: flex;
            flex-direction: column;
        }

        .property label {
            margin-bottom: 5px;
            font-size: 0.9rem;
        }

        .property input, .property select {
            padding: 8px;
            border-radius: 6px;
            border: none;
            background: rgba(255, 255, 255, 0.15);
            color: white;
        }

        .property input::placeholder {
            color: rgba(255, 255, 255, 0.7);
        }

        .buttons {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }

        .btn {
            padding: 10px 15px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .btn-primary {
            background: linear-gradient(135deg, #ff7e5f, #feb47b);
            color: white;
        }

        .btn-secondary {
            background: rgba(255, 255, 255, 0.2);
            color: white;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }

        .controls {
            display: flex;
            justify-content: space-between;
            margin-top: 20px;
        }

        .turtle {
            position: absolute;
            width: 80px;
            height: 80px;
            transition: transform 0.3s;
            pointer-events: none;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }

        .modal-content {
            background: linear-gradient(135deg, #1a2a6c, #b21f1f);
            padding: 30px;
            border-radius: 15px;
            width: 500px;
            max-width: 90%;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
        }

        .modal h2 {
            margin-bottom: 20px;
            text-align: center;
            color: #ffcc00;
        }

        .close-modal {
            float: right;
            font-size: 1.5rem;
            cursor: pointer;
        }

        footer {
            text-align: center;
            padding: 20px 0;
            margin-top: 30px;
            border-top: 1px solid rgba(255, 255, 255, 0.2);
            font-size: 0.9rem;
            color: rgba(255, 255, 255, 0.7);
        }

        .block-input {
            width: 50px;
            padding: 2px 5px;
            border: none;
            border-radius: 3px;
            background: rgba(255, 255, 255, 0.2);
            color: white;
            text-align: center;
        }

        .block-drop-zone {
            min-height: 50px;
            border: 2px dashed rgba(255, 255, 255, 0.3);
            border-radius: 8px;
            margin: 5px 0;
            padding: 10px;
            transition: all 0.2s;
        }

        .block-drop-zone.active {
            border-color: #ffcc00;
            background: rgba(255, 204, 0, 0.1);
        }

        .sensor-value {
            background: rgba(0, 255, 0, 0.2);
            padding: 5px 10px;
            border-radius: 4px;
            font-family: monospace;
            margin-left: 10px;
        }

        @media (max-width: 1100px) {
            .main-content {
                grid-template-columns: 1fr;
                grid-template-rows: auto 1fr auto;
                height: auto;
            }
            
            .categories, .properties {
                height: 300px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <div class="logo">
                <img src="https://i0.wp.com/gas-kvas.com/grafic/uploads/posts/2024-01/gas-kvas-com-p-cherepakha-dlya-detei-na-prozrachnom-fone-4.png?ssl=1" alt="TurtleBlocks Logo">
                <h1>TurtleBlocks</h1>
            </div>
            <button class="help-btn" id="help-btn">
                <span>‚ùì –ü–æ–º–æ—â—å</span>
            </button>
        </header>

        <div class="main-content">
            <div class="categories">
                <div class="category">
                    <h3>üöÄ –î–≤–∏–∂–µ–Ω–∏–µ</h3>
                    <div class="blocks-container">
                        <div class="block" data-type="move" data-params="steps">
                            <div>–ò–¥—Ç–∏ <input type="number" class="block-input" value="10" data-param="steps"> —à–∞–≥–æ–≤</div>
                        </div>
                        <div class="block" data-type="turn" data-params="degrees">
                            <div>–ü–æ–≤–µ—Ä–Ω—É—Ç—å ‚Üª <input type="number" class="block-input" value="15" data-param="degrees">¬∞</div>
                        </div>
                        <div class="block" data-type="turn-left" data-params="degrees">
                            <div>–ü–æ–≤–µ—Ä–Ω—É—Ç—å ‚Ü∫ <input type="number" class="block-input" value="15" data-param="degrees">¬∞</div>
                        </div>
                        <div class="block" data-type="goto" data-params="x,y">
                            <div>–ü–µ—Ä–µ–π—Ç–∏ –≤ x:<input type="number" class="block-input" value="0" data-param="x"> y:<input type="number" class="block-input" value="0" data-param="y"></div>
                        </div>
                        <div class="block" data-type="glide" data-params="x,y,secs">
                            <div>–ü–ª–∞–≤–Ω–æ –∫ x:<input type="number" class="block-input" value="0" data-param="x"> y:<input type="number" class="block-input" value="0" data-param="y"> –∑–∞ <input type="number" class="block-input" value="1" data-param="secs"> —Å–µ–∫</div>
                        </div>
                        <div class="block" data-type="point-direction" data-params="direction">
                            <div>–ù–∞–ø—Ä–∞–≤–∏—Ç—å—Å—è –≤ <input type="number" class="block-input" value="90" data-param="direction">¬∞</div>
                        </div>
                    </div>
                </div>
                
                <div class="category">
                    <h3>üé® –í–Ω–µ—à–Ω–∏–π –≤–∏–¥</h3>
                    <div class="blocks-container">
                        <div class="block" data-type="say" data-params="text">
                            <div>–°–∫–∞–∑–∞—Ç—å <input type="text" class="block-input" value="–ü—Ä–∏–≤–µ—Ç!" data-param="text"></div>
                        </div>
                        <div class="block" data-type="think" data-params="text">
                            <div>–î—É–º–∞—Ç—å <input type="text" class="block-input" value="–û —á–µ–º-—Ç–æ" data-param="text"></div>
                        </div>
                        <div class="block" data-type="show">–ü–æ–∫–∞–∑–∞—Ç—å—Å—è</div>
                        <div class="block" data-type="hide">–°–ø—Ä—è—Ç–∞—Ç—å—Å—è</div>
                        <div class="block" data-type="size" data-params="size">
                            <div>–ò–∑–º–µ–Ω–∏—Ç—å —Ä–∞–∑–º–µ—Ä –Ω–∞ <input type="number" class="block-input" value="10" data-param="size"></div>
                        </div>
                    </div>
                </div>
                
                <div class="category">
                    <h3>‚úèÔ∏è –ü–µ—Ä–æ</h3>
                    <div class="blocks-container">
                        <div class="block" data-type="pen-down">–û–ø—É—Å—Ç–∏—Ç—å –ø–µ—Ä–æ</div>
                        <div class="block" data-type="pen-up">–ü–æ–¥–Ω—è—Ç—å –ø–µ—Ä–æ</div>
                        <div class="block" data-type="pen-color" data-params="color">
                            <div>–¶–≤–µ—Ç –ø–µ—Ä–∞ <input type="color" class="block-input" value="#ff0000" data-param="color"></div>
                        </div>
                        <div class="block" data-type="pen-size" data-params="size">
                            <div>–†–∞–∑–º–µ—Ä –ø–µ—Ä–∞ <input type="number" class="block-input" value="2" data-param="size"></div>
                        </div>
                        <div class="block" data-type="stamp">–®—Ç–∞–º–ø</div>
                        <div class="block" data-type="clear">–û—á–∏—Å—Ç–∏—Ç—å</div>
                    </div>
                </div>
                
                <div class="category">
                    <h3>üéµ –ó–≤—É–∫</h3>
                    <div class="blocks-container">
                        <div class="block" data-type="play-sound">–ò–≥—Ä–∞—Ç—å –∑–≤—É–∫</div>
                        <div class="block" data-type="stop-sound">–û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –≤—Å–µ –∑–≤—É–∫–∏</div>
                        <div class="block" data-type="beep">–ò–∑–¥–∞—Ç—å –∑–≤—É–∫</div>
                        <div class="block" data-type="play-note" data-params="note">
                            <div>–ò–≥—Ä–∞—Ç—å –Ω–æ—Ç—É <input type="number" class="block-input" value="60" data-param="note"></div>
                        </div>
                    </div>
                </div>
                
                <div class="category">
                    <h3>üïπÔ∏è –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ</h3>
                    <div class="blocks-container">
                        <div class="block" data-type="when-flag-clicked">–ö–æ–≥–¥–∞ —â–µ–ª–∫–Ω—É—Ç –ø–æ —Ñ–ª–∞–≥—É</div>
                        <div class="block" data-type="when-clicked">–ö–æ–≥–¥–∞ —â–µ–ª–∫–Ω—É—Ç –ø–æ —á–µ—Ä–µ–ø–∞—Ö–µ</div>
                        <div class="block" data-type="when-key" data-params="key">
                            <div>–ö–æ–≥–¥–∞ –Ω–∞–∂–∞—Ç–∞ –∫–ª–∞–≤–∏—à–∞ <input type="text" class="block-input" value="–ø—Ä–æ–±–µ–ª" data-param="key"></div>
                        </div>
                        <div class="block" data-type="forever">–ü–æ–≤—Ç–æ—Ä—è—Ç—å –≤—Å–µ–≥–¥–∞</div>
                        <div class="block" data-type="repeat" data-params="times">
                            <div>–ü–æ–≤—Ç–æ—Ä–∏—Ç—å <input type="number" class="block-input" value="10" data-param="times"> —Ä–∞–∑</div>
                        </div>
                        <div class="block" data-type="wait" data-params="secs">
                            <div>–ñ–¥–∞—Ç—å <input type="number" class="block-input" value="1" data-param="secs"> —Å–µ–∫—É–Ω–¥</div>
                        </div>
                    </div>
                </div>
                
                <div class="category">
                    <h3>üéØ –°–µ–Ω—Å–æ—Ä—ã</h3>
                    <div class="blocks-container">
                        <div class="block" data-type="touching-edge">–ö–∞—Å–∞–µ—Ç—Å—è –∫—Ä–∞—è?</div>
                        <div class="block" data-type="mouse-x">–ö–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞ X –º—ã—à–∏</div>
                        <div class="block" data-type="mouse-y">–ö–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞ Y –º—ã—à–∏</div>
                        <div class="block" data-type="key-pressed" data-params="key">
                            <div>–ö–ª–∞–≤–∏—à–∞ <input type="text" class="block-input" value="–ø—Ä–æ–±–µ–ª" data-param="key"> –Ω–∞–∂–∞—Ç–∞?</div>
                        </div>
                        <div class="block" data-type="distance-to-mouse">–†–∞—Å—Å—Ç–æ—è–Ω–∏–µ –¥–æ –º—ã—à–∏</div>
                        <div class="block" data-type="timer">–¢–∞–π–º–µ—Ä</div>
                    </div>
                </div>
                
                <div class="category">
                    <h3>üîß –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –±–ª–æ–∫–∏</h3>
                    <div class="blocks-container">
                        <div class="block" data-type="chase-mouse">–ü—Ä–µ—Å–ª–µ–¥–æ–≤–∞—Ç—å –º—ã—à—å</div>
                        <div class="block" data-type="wasd-controls">–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ WASD</div>
                        <div class="block" data-type="draw-square">–ù–∞—Ä–∏—Å–æ–≤–∞—Ç—å –∫–≤–∞–¥—Ä–∞—Ç</div>
                        <div class="block" data-type="draw-circle">–ù–∞—Ä–∏—Å–æ–≤–∞—Ç—å –∫—Ä—É–≥</div>
                        <div class="block" data-type="draw-star">–ù–∞—Ä–∏—Å–æ–≤–∞—Ç—å –∑–≤–µ–∑–¥—É</div>
                        <div class="block" data-type="spiral">–ù–∞—Ä–∏—Å–æ–≤–∞—Ç—å —Å–ø–∏—Ä–∞–ª—å</div>
                    </div>
                </div>
            </div>

            <div class="workspace">
                <div class="stage-container">
                    <canvas id="stage" width="800" height="500"></canvas>
                    <img src="https://i0.wp.com/gas-kvas.com/grafic/uploads/posts/2024-01/gas-kvas-com-p-cherepakha-dlya-detei-na-prozrachnom-fone-4.png?ssl=1" alt="Turtle" class="turtle" id="turtle">
                    <div id="speech-bubble" style="display: none; position: absolute; background: white; color: black; padding: 10px; border-radius: 10px; max-width: 200px; font-size: 14px;"></div>
                </div>
                <div class="controls">
                    <button class="btn btn-primary" id="run-btn">
                        <span>‚ñ∂ –ó–∞–ø—É—Å–∫</span>
                    </button>
                    <button class="btn btn-secondary" id="stop-btn">
                        <span>‚èπ –°—Ç–æ–ø</span>
                    </button>
                    <button class="btn btn-secondary" id="clear-btn">
                        <span>üóë –û—á–∏—Å—Ç–∏—Ç—å</span>
                    </button>
                    <button class="btn btn-secondary" id="upload-btn">
                        <span>üìÅ –ó–∞–≥—Ä—É–∑–∏—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ</span>
                    </button>
                </div>
                <div class="code-area" id="code-area">
                    <div class="block-drop-zone" id="main-drop-zone">
                        –ü–µ—Ä–µ—Ç–∞—â–∏—Ç–µ –±–ª–æ–∫–∏ —Å—é–¥–∞ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –ø—Ä–æ–≥—Ä–∞–º–º—ã
                    </div>
                </div>
            </div>

            <div class="properties">
                <div class="property-group">
                    <h3>üê¢ –°–≤–æ–π—Å—Ç–≤–∞ —á–µ—Ä–µ–ø–∞—Ö–∏</h3>
                    <div class="property">
                        <label for="turtle-x">–ü–æ–∑–∏—Ü–∏—è X: <span id="turtle-x-value">400</span></label>
                        <input type="range" id="turtle-x" min="0" max="800" value="400">
                    </div>
                    <div class="property">
                        <label for="turtle-y">–ü–æ–∑–∏—Ü–∏—è Y: <span id="turtle-y-value">250</span></label>
                        <input type="range" id="turtle-y" min="0" max="500" value="250">
                    </div>
                    <div class="property">
                        <label for="turtle-direction">–ù–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ: <span id="turtle-direction-value">90</span>¬∞</label>
                        <input type="range" id="turtle-direction" min="0" max="360" value="90">
                    </div>
                    <div class="property">
                        <label for="turtle-size">–†–∞–∑–º–µ—Ä: <span id="turtle-size-value">80</span>px</label>
                        <input type="range" id="turtle-size" min="20" max="150" value="80">
                    </div>
                    <div class="property">
                        <label for="turtle-visible">–í–∏–¥–∏–º–æ—Å—Ç—å:</label>
                        <select id="turtle-visible">
                            <option value="true">–í–∏–¥–∏–º—ã–π</option>
                            <option value="false">–°–∫—Ä—ã—Ç—ã–π</option>
                        </select>
                    </div>
                </div>
                
                <div class="property-group">
                    <h3>‚úèÔ∏è –°–≤–æ–π—Å—Ç–≤–∞ –ø–µ—Ä–∞</h3>
                    <div class="property">
                        <label for="pen-color">–¶–≤–µ—Ç –ø–µ—Ä–∞:</label>
                        <input type="color" id="pen-color" value="#ff0000">
                    </div>
                    <div class="property">
                        <label for="pen-size">–†–∞–∑–º–µ—Ä –ø–µ—Ä–∞: <span id="pen-size-value">2</span></label>
                        <input type="range" id="pen-size" min="1" max="20" value="2">
                    </div>
                    <div class="property">
                        <label for="pen-down">–°–æ—Å—Ç–æ—è–Ω–∏–µ –ø–µ—Ä–∞:</label>
                        <select id="pen-down">
                            <option value="true">–û–ø—É—â–µ–Ω–æ</option>
                            <option value="false">–ü–æ–¥–Ω—è—Ç–æ</option>
                        </select>
                    </div>
                </div>
                
                <div class="property-group">
                    <h3>üéµ –ó–≤—É–∫</h3>
                    <div class="property">
                        <label for="sound-volume">–ì—Ä–æ–º–∫–æ—Å—Ç—å: <span id="sound-volume-value">50</span>%</label>
                        <input type="range" id="sound-volume" min="0" max="100" value="50">
                    </div>
                </div>
                
                <div class="property-group">
                    <h3>üìä –°–µ–Ω—Å–æ—Ä—ã</h3>
                    <div class="property">
                        <label>–ö–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞ X: <span class="sensor-value" id="sensor-x">400</span></label>
                    </div>
                    <div class="property">
                        <label>–ö–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞ Y: <span class="sensor-value" id="sensor-y">250</span></label>
                    </div>
                    <div class="property">
                        <label>–ù–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ: <span class="sensor-value" id="sensor-direction">90¬∞</span></label>
                    </div>
                    <div class="property">
                        <label>–¢–∞–π–º–µ—Ä: <span class="sensor-value" id="sensor-timer">0.0</span> —Å–µ–∫</label>
                    </div>
                </div>
                
                <div class="buttons">
                    <button class="btn btn-primary" id="save-project">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –ø—Ä–æ–µ–∫—Ç</button>
                    <button class="btn btn-secondary" id="load-project">–ó–∞–≥—Ä—É–∑–∏—Ç—å –ø—Ä–æ–µ–∫—Ç</button>
                </div>
            </div>
        </div>

        <footer>
            <p>TurtleBlocks &copy; 2025 - –í–∏–∑—É–∞–ª—å–Ω–∞—è —Å—Ä–µ–¥–∞ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è –¥–ª—è –≤—Å–µ—Ö –≤–æ–∑—Ä–∞—Å—Ç–æ–≤</p>
        </footer>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π -->
    <div class="modal" id="upload-modal">
        <div class="modal-content">
            <span class="close-modal" id="close-upload-modal">&times;</span>
            <h2>–ó–∞–≥—Ä—É–∑–∏—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ</h2>
            <div class="property">
                <label for="image-url">URL –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è:</label>
                <input type="text" id="image-url" placeholder="–í–≤–µ–¥–∏—Ç–µ URL –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è">
            </div>
            <div class="property">
                <label for="image-file">–ò–ª–∏ –≤—ã–±–µ—Ä–∏—Ç–µ —Ñ–∞–π–ª:</label>
                <input type="file" id="image-file" accept="image/*">
            </div>
            <div class="buttons" style="margin-top: 20px;">
                <button class="btn btn-primary" id="confirm-upload">–ó–∞–≥—Ä—É–∑–∏—Ç—å</button>
                <button class="btn btn-secondary" id="cancel-upload">–û—Ç–º–µ–Ω–∞</button>
            </div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –ø–æ–º–æ—â–∏ -->
    <div class="modal" id="help-modal">
        <div class="modal-content">
            <span class="close-modal" id="close-help-modal">&times;</span>
            <h2>–ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å TurtleBlocks</h2>
            <div style="max-height: 400px; overflow-y: auto;">
                <h3>–û—Å–Ω–æ–≤—ã –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è:</h3>
                <p>1. <strong>–ü–µ—Ä–µ—Ç–∞—â–∏—Ç–µ –±–ª–æ–∫–∏</strong> –∏–∑ –ª–µ–≤–æ–π –ø–∞–Ω–µ–ª–∏ –≤ –æ–±–ª–∞—Å—Ç—å –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è</p>
                <p>2. <strong>–°–æ–±–µ—Ä–∏—Ç–µ –ø—Ä–æ–≥—Ä–∞–º–º—É</strong>, —Å–æ–µ–¥–∏–Ω—è—è –±–ª–æ–∫–∏ –¥—Ä—É–≥ —Å –¥—Ä—É–≥–æ–º</p>
                <p>3. <strong>–ù–∞–∂–º–∏—Ç–µ "–ó–∞–ø—É—Å–∫"</strong> —á—Ç–æ–±—ã –≤—ã–ø–æ–ª–Ω–∏—Ç—å –ø—Ä–æ–≥—Ä–∞–º–º—É</p>
                
                <h3>–ü—Ä–∏–º–µ—Ä—ã –ø—Ä–æ–≥—Ä–∞–º–º:</h3>
                <p><strong>–ö–≤–∞–¥—Ä–∞—Ç:</strong> "–ö–æ–≥–¥–∞ —â–µ–ª–∫–Ω—É—Ç –ø–æ —Ñ–ª–∞–≥—É" ‚Üí "–ü–æ–≤—Ç–æ—Ä–∏—Ç—å 4 —Ä–∞–∑–∞" ‚Üí "–ò–¥—Ç–∏ 100 —à–∞–≥–æ–≤" ‚Üí "–ü–æ–≤–µ—Ä–Ω—É—Ç—å ‚Üª 90¬∞"</p>
                <p><strong>–°–ø–∏—Ä–∞–ª—å:</strong> "–ö–æ–≥–¥–∞ —â–µ–ª–∫–Ω—É—Ç –ø–æ —Ñ–ª–∞–≥—É" ‚Üí "–ü–æ–≤—Ç–æ—Ä—è—Ç—å –≤—Å–µ–≥–¥–∞" ‚Üí "–ò–¥—Ç–∏ 10 —à–∞–≥–æ–≤" ‚Üí "–ü–æ–≤–µ—Ä–Ω—É—Ç—å ‚Üª 89¬∞"</p>
                <p><strong>–†–∏—Å–æ–≤–∞–Ω–∏–µ:</strong> –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –±–ª–æ–∫–∏ –ø–µ—Ä–∞ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Ä–∏—Å—É–Ω–∫–æ–≤</p>
                
                <h3>–°–µ–Ω—Å–æ—Ä—ã:</h3>
                <p>–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –±–ª–æ–∫–∏ —Å–µ–Ω—Å–æ—Ä–æ–≤ –¥–ª—è –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å –º—ã—à—å—é –∏ –∫–ª–∞–≤–∏–∞—Ç—É—Ä–æ–π</p>
            </div>
            <div class="buttons" style="margin-top: 20px;">
                <button class="btn btn-primary" id="close-help">–ü–æ–Ω—è—Ç–Ω–æ</button>
            </div>
        </div>
    </div>

    <script>
        // –û—Å–Ω–æ–≤–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
        const stage = document.getElementById('stage');
        const ctx = stage.getContext('2d');
        const turtle = document.getElementById('turtle');
        const codeArea = document.getElementById('code-area');
        const runBtn = document.getElementById('run-btn');
        const stopBtn = document.getElementById('stop-btn');
        const clearBtn = document.getElementById('clear-btn');
        const uploadBtn = document.getElementById('upload-btn');
        const helpBtn = document.getElementById('help-btn');
        const uploadModal = document.getElementById('upload-modal');
        const helpModal = document.getElementById('help-modal');
        
        // –ü–æ–∑–∏—Ü–∏—è –∏ —Å–æ—Å—Ç–æ—è–Ω–∏–µ —á–µ—Ä–µ–ø–∞—Ö–∏
        let turtleX = stage.width / 2;
        let turtleY = stage.height / 2;
        let turtleDirection = 90; // –≥—Ä–∞–¥—É—Å—ã, 0 = –≤–≤–µ—Ä—Ö, 90 = –≤–ø—Ä–∞–≤–æ
        let penDown = true;
        let penColor = '#ff0000';
        let penSize = 2;
        let isRunning = false;
        let currentProgram = null;
        let timerStart = 0;
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        function init() {
            // –û—á–∏—Å—Ç–∫–∞ —Ö–æ–ª—Å—Ç–∞
            resetStage();
            
            // –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –Ω–∞—á–∞–ª—å–Ω–æ–π –ø–æ–∑–∏—Ü–∏–∏ —á–µ—Ä–µ–ø–∞—Ö–∏
            updateTurtlePosition();
            
            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π –¥–ª—è –±–ª–æ–∫–æ–≤
            document.querySelectorAll('.block').forEach(block => {
                block.addEventListener('dragstart', handleDragStart);
            });
            
            codeArea.addEventListener('dragover', handleDragOver);
            codeArea.addEventListener('drop', handleDrop);
            codeArea.addEventListener('dragenter', handleDragEnter);
            codeArea.addEventListener('dragleave', handleDragLeave);
            
            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∫–Ω–æ–ø–æ–∫
            runBtn.addEventListener('click', runCode);
            stopBtn.addEventListener('click', stopCode);
            clearBtn.addEventListener('click', clearCode);
            uploadBtn.addEventListener('click', () => uploadModal.style.display = 'flex');
            helpBtn.addEventListener('click', () => helpModal.style.display = 'flex');
            
            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–æ–Ω
            document.getElementById('close-upload-modal').addEventListener('click', () => uploadModal.style.display = 'none');
            document.getElementById('cancel-upload').addEventListener('click', () => uploadModal.style.display = 'none');
            document.getElementById('confirm-upload').addEventListener('click', uploadImage);
            document.getElementById('close-help-modal').addEventListener('click', () => helpModal.style.display = 'none');
            document.getElementById('close-help').addEventListener('click', () => helpModal.style.display = 'none');
            
            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–≤–æ–π—Å—Ç–≤
            document.getElementById('turtle-x').addEventListener('input', updateTurtleFromProperties);
            document.getElementById('turtle-y').addEventListener('input', updateTurtleFromProperties);
            document.getElementById('turtle-direction').addEventListener('input', updateTurtleFromProperties);
            document.getElementById('turtle-size').addEventListener('input', updateTurtleFromProperties);
            document.getElementById('turtle-visible').addEventListener('change', updateTurtleFromProperties);
            document.getElementById('pen-color').addEventListener('input', updatePenFromProperties);
            document.getElementById('pen-size').addEventListener('input', updatePenFromProperties);
            document.getElementById('pen-down').addEventListener('change', updatePenFromProperties);
            document.getElementById('sound-volume').addEventListener('input', updateSoundFromProperties);
            
            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–µ–Ω—Å–æ—Ä–æ–≤
            stage.addEventListener('mousemove', updateMouseSensors);
            document.addEventListener('keydown', handleKeyDown);
            document.addEventListener('keyup', handleKeyUp);
            
            // –ó–∞–ø—É—Å–∫ —Ç–∞–π–º–µ—Ä–∞ –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å–µ–Ω—Å–æ—Ä–æ–≤
            timerStart = Date.now();
            setInterval(updateSensors, 100);
            
            // –î–æ–±–∞–≤–ª—è–µ–º –ø—Ä–∏–º–µ—Ä –ø—Ä–æ–≥—Ä–∞–º–º—ã
            createExampleProgram();
        }
        
        // –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–∏–º–µ—Ä–∞ –ø—Ä–æ–≥—Ä–∞–º–º—ã
        function createExampleProgram() {
            const dropZone = document.getElementById('main-drop-zone');
            dropZone.innerHTML = '';
            
            // –°–æ–∑–¥–∞–µ–º –ø—Ä–æ–≥—Ä–∞–º–º—É "–ö–≤–∞–¥—Ä–∞—Ç"
            const whenFlag = createCodeBlock('when-flag-clicked');
            const repeat = createCodeBlock('repeat', {times: 4});
            const move = createCodeBlock('move', {steps: 100});
            const turn = createCodeBlock('turn', {degrees: 90});
            
            // –°–æ–±–∏—Ä–∞–µ–º –ø—Ä–æ–≥—Ä–∞–º–º—É
            whenFlag.appendChild(repeat);
            repeat.appendChild(move);
            repeat.appendChild(turn);
            
            dropZone.appendChild(whenFlag);
        }
        
        // –°–æ–∑–¥–∞–Ω–∏–µ –±–ª–æ–∫–∞ –∫–æ–¥–∞
        function createCodeBlock(type, params = {}) {
            const block = document.createElement('div');
            block.className = 'code-line';
            block.draggable = true;
            block.dataset.type = type;
            
            let html = '';
            switch(type) {
                case 'when-flag-clicked':
                    html = '–ö–æ–≥–¥–∞ —â–µ–ª–∫–Ω—É—Ç –ø–æ —Ñ–ª–∞–≥—É';
                    break;
                case 'repeat':
                    html = `–ü–æ–≤—Ç–æ—Ä–∏—Ç—å <input type="number" class="block-input" value="${params.times || 10}" data-param="times"> —Ä–∞–∑`;
                    break;
                case 'move':
                    html = `–ò–¥—Ç–∏ <input type="number" class="block-input" value="${params.steps || 10}" data-param="steps"> —à–∞–≥–æ–≤`;
                    break;
                case 'turn':
                    html = `–ü–æ–≤–µ—Ä–Ω—É—Ç—å ‚Üª <input type="number" class="block-input" value="${params.degrees || 15}" data-param="degrees">¬∞`;
                    break;
                default:
                    html = '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π –±–ª–æ–∫';
            }
            
            block.innerHTML = html;
            block.addEventListener('dragstart', handleCodeBlockDragStart);
            block.addEventListener('dragover', handleCodeBlockDragOver);
            block.addEventListener('drop', handleCodeBlockDrop);
            
            return block;
        }
        
        // –°–±—Ä–æ—Å —Å—Ü–µ–Ω—ã
        function resetStage() {
            ctx.clearRect(0, 0, stage.width, stage.height);
            ctx.fillStyle = '#ffffff';
            ctx.fillRect(0, 0, stage.width, stage.height);
        }
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ–∑–∏—Ü–∏–∏ —á–µ—Ä–µ–ø–∞—Ö–∏
        function updateTurtlePosition() {
            turtle.style.left = (turtleX - turtle.width / 2) + 'px';
            turtle.style.top = (turtleY - turtle.height / 2) + 'px';
            turtle.style.transform = `rotate(${360 - turtleDirection}deg)`;
            
            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–≤–æ–π—Å—Ç–≤ –≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ
            document.getElementById('turtle-x').value = Math.round(turtleX);
            document.getElementById('turtle-y').value = Math.round(turtleY);
            document.getElementById('turtle-direction').value = turtleDirection;
            
            document.getElementById('turtle-x-value').textContent = Math.round(turtleX);
            document.getElementById('turtle-y-value').textContent = Math.round(turtleY);
            document.getElementById('turtle-direction-value').textContent = turtleDirection;
        }
        
        // –ü–µ—Ä–µ–º–µ—â–µ–Ω–∏–µ —á–µ—Ä–µ–ø–∞—Ö–∏
        function moveTurtle(steps) {
            const radians = turtleDirection * Math.PI / 180;
            const newX = turtleX + steps * Math.cos(radians);
            const newY = turtleY - steps * Math.sin(radians);
            
            if (penDown) {
                ctx.beginPath();
                ctx.strokeStyle = penColor;
                ctx.lineWidth = penSize;
                ctx.lineCap = 'round';
                ctx.moveTo(turtleX, turtleY);
                ctx.lineTo(newX, newY);
                ctx.stroke();
            }
            
            turtleX = newX;
            turtleY = newY;
            updateTurtlePosition();
        }
        
        // –ü–æ–≤–æ—Ä–æ—Ç —á–µ—Ä–µ–ø–∞—Ö–∏
        function turnTurtle(degrees) {
            turtleDirection = (turtleDirection + degrees) % 360;
            if (turtleDirection < 0) turtleDirection += 360;
            updateTurtlePosition();
        }
        
        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ drag and drop –¥–ª—è –±–ª–æ–∫–æ–≤
        function handleDragStart(e) {
            const blockType = e.target.getAttribute('data-type');
            const params = {};
            
            // –°–æ–±–∏—Ä–∞–µ–º –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∏–∑ input'–æ–≤
            if (e.target.hasAttribute('data-params')) {
                const paramNames = e.target.getAttribute('data-params').split(',');
                paramNames.forEach(param => {
                    const input = e.target.querySelector(`[data-param="${param}"]`);
                    if (input) {
                        params[param] = input.value;
                    }
                });
            }
            
            e.dataTransfer.setData('application/json', JSON.stringify({
                type: blockType,
                params: params
            }));
        }
        
        function handleDragOver(e) {
            e.preventDefault();
        }
        
        function handleDragEnter(e) {
            e.preventDefault();
            if (e.target.classList.contains('block-drop-zone')) {
                e.target.classList.add('active');
            }
        }
        
        function handleDragLeave(e) {
            if (e.target.classList.contains('block-drop-zone')) {
                e.target.classList.remove('active');
            }
        }
        
        function handleDrop(e) {
            e.preventDefault();
            if (e.target.classList.contains('block-drop-zone')) {
                e.target.classList.remove('active');
                
                const data = JSON.parse(e.dataTransfer.getData('application/json'));
                const newBlock = createCodeBlock(data.type, data.params);
                
                // –ï—Å–ª–∏ —ç—Ç–æ –±–ª–æ–∫ —Å–æ–±—ã—Ç–∏—è, –¥–æ–±–∞–≤–ª—è–µ–º –µ–≥–æ –≤ –Ω–∞—á–∞–ª–æ
                if (data.type.startsWith('when-')) {
                    e.target.prepend(newBlock);
                } else {
                    e.target.appendChild(newBlock);
                }
            }
        }
        
        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –±–ª–æ–∫–æ–≤ –∫–æ–¥–∞
        function handleCodeBlockDragStart(e) {
            e.dataTransfer.setData('text/plain', 'code-block');
            e.target.classList.add('dragging');
        }
        
        function handleCodeBlockDragOver(e) {
            e.preventDefault();
        }
        
        function handleCodeBlockDrop(e) {
            e.preventDefault();
            // –ó–¥–µ—Å—å –º–æ–∂–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –ø–µ—Ä–µ—Å—Ç–∞–Ω–æ–≤–∫—É –±–ª–æ–∫–æ–≤ –∫–æ–¥–∞
        }
        
        // –ó–∞–ø—É—Å–∫ –∫–æ–¥–∞
        function runCode() {
            if (isRunning) return;
            
            isRunning = true;
            runBtn.disabled = true;
            stopBtn.disabled = false;
            
            // –°–±–æ—Ä–∫–∞ –ø—Ä–æ–≥—Ä–∞–º–º—ã –∏–∑ –±–ª–æ–∫–æ–≤
            const program = [];
            const eventBlocks = document.querySelectorAll('.code-line[data-type^="when-"]');
            
            // –ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö –±–ª–æ–∫–æ–≤ —Å–æ–±—ã—Ç–∏–π
            eventBlocks.forEach(block => {
                executeBlock(block);
            });
        }
        
        // –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –±–ª–æ–∫–∞ –∏ –µ–≥–æ –¥–æ—á–µ—Ä–Ω–∏—Ö –±–ª–æ–∫–æ–≤
        function executeBlock(block) {
            const type = block.dataset.type;
            const params = {};
            
            // –°–±–æ—Ä –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –∏–∑ input'–æ–≤
            block.querySelectorAll('.block-input').forEach(input => {
                const paramName = input.dataset.param;
                if (input.type === 'number') {
                    params[paramName] = parseInt(input.value);
                } else if (input.type === 'color') {
                    params[paramName] = input.value;
                } else {
                    params[paramName] = input.value;
                }
            });
            
            // –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –±–ª–æ–∫–∞ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ç–∏–ø–∞
            switch(type) {
                case 'when-flag-clicked':
                    // –ó–∞–ø—É—Å–∫–∞–µ–º –¥–æ—á–µ—Ä–Ω–∏–µ –±–ª–æ–∫–∏
                    Array.from(block.children).forEach(child => {
                        if (child.classList.contains('code-line')) {
                            executeBlock(child);
                        }
                    });
                    break;
                    
                case 'move':
                    moveTurtle(params.steps || 10);
                    break;
                    
                case 'turn':
                    turnTurtle(params.degrees || 15);
                    break;
                    
                case 'repeat':
                    const times = params.times || 10;
                    for (let i = 0; i < times; i++) {
                        Array.from(block.children).forEach(child => {
                            if (child.classList.contains('code-line')) {
                                executeBlock(child);
                            }
                        });
                    }
                    break;
                    
                case 'pen-down':
                    penDown = true;
                    break;
                    
                case 'pen-up':
                    penDown = false;
                    break;
                    
                case 'clear':
                    resetStage();
                    break;
                    
                case 'draw-square':
                    for (let i = 0; i < 4; i++) {
                        moveTurtle(100);
                        turnTurtle(90);
                    }
                    break;
                    
                case 'draw-circle':
                    for (let i = 0; i < 36; i++) {
                        moveTurtle(10);
                        turnTurtle(10);
                    }
                    break;
                    
                case 'spiral':
                    for (let i = 0; i < 100; i++) {
                        moveTurtle(i);
                        turnTurtle(89);
                    }
                    break;
            }
        }
        
        // –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –∫–æ–¥–∞
        function stopCode() {
            isRunning = false;
            runBtn.disabled = false;
            stopBtn.disabled = true;
        }
        
        // –û—á–∏—Å—Ç–∫–∞ –∫–æ–¥–∞ –∏ —Å—Ü–µ–Ω—ã
        function clearCode() {
            const dropZone = document.getElementById('main-drop-zone');
            dropZone.innerHTML = '–ü–µ—Ä–µ—Ç–∞—â–∏—Ç–µ –±–ª–æ–∫–∏ —Å—é–¥–∞ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –ø—Ä–æ–≥—Ä–∞–º–º—ã';
            resetStage();
            
            // –°–±—Ä–æ—Å –ø–æ–∑–∏—Ü–∏–∏ —á–µ—Ä–µ–ø–∞—Ö–∏
            turtleX = stage.width / 2;
            turtleY = stage.height / 2;
            turtleDirection = 90;
            updateTurtlePosition();
        }
        
        // –ó–∞–≥—Ä—É–∑–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
        function uploadImage() {
            const imageUrl = document.getElementById('image-url').value;
            const imageFile = document.getElementById('image-file').files[0];
            
            if (imageUrl) {
                turtle.src = imageUrl;
                uploadModal.style.display = 'none';
            } else if (imageFile) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    turtle.src = e.target.result;
                };
                reader.readAsDataURL(imageFile);
                uploadModal.style.display = 'none';
            } else {
                alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–µ—Ä–∏—Ç–µ —Ñ–∞–π–ª –∏–ª–∏ –≤–≤–µ–¥–∏—Ç–µ URL –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è');
            }
        }
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–≤–æ–π—Å—Ç–≤ —á–µ—Ä–µ–ø–∞—Ö–∏ –∏–∑ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
        function updateTurtleFromProperties() {
            turtleX = parseInt(document.getElementById('turtle-x').value);
            turtleY = parseInt(document.getElementById('turtle-y').value);
            turtleDirection = parseInt(document.getElementById('turtle-direction').value);
            const size = parseInt(document.getElementById('turtle-size').value);
            const visible = document.getElementById('turtle-visible').value === 'true';
            
            turtle.style.width = size + 'px';
            turtle.style.height = size + 'px';
            turtle.style.display = visible ? 'block' : 'none';
            
            updateTurtlePosition();
        }
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–≤–æ–π—Å—Ç–≤ –ø–µ—Ä–∞ –∏–∑ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
        function updatePenFromProperties() {
            penColor = document.getElementById('pen-color').value;
            penSize = parseInt(document.getElementById('pen-size').value);
            penDown = document.getElementById('pen-down').value === 'true';
            
            document.getElementById('pen-size-value').textContent = penSize;
        }
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–≤–æ–π—Å—Ç–≤ –∑–≤—É–∫–∞ –∏–∑ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
        function updateSoundFromProperties() {
            const volume = parseInt(document.getElementById('sound-volume').value);
            document.getElementById('sound-volume-value').textContent = volume;
        }
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–µ–Ω—Å–æ—Ä–æ–≤
        function updateSensors() {
            document.getElementById('sensor-x').textContent = Math.round(turtleX);
            document.getElementById('sensor-y').textContent = Math.round(turtleY);
            document.getElementById('sensor-direction').textContent = turtleDirection + '¬∞';
            
            const timerValue = ((Date.now() - timerStart) / 1000).toFixed(1);
            document.getElementById('sensor-timer').textContent = timerValue;
        }
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ–∑–∏—Ü–∏–∏ –º—ã—à–∏ –¥–ª—è —Å–µ–Ω—Å–æ—Ä–æ–≤
        function updateMouseSensors(e) {
            const rect = stage.getBoundingClientRect();
            const mouseX = e.clientX - rect.left;
            const mouseY = e.clientY - rect.top;
            
            // –ó–¥–µ—Å—å –º–æ–∂–Ω–æ –æ–±–Ω–æ–≤–ª—è—Ç—å –∑–Ω–∞—á–µ–Ω–∏—è —Å–µ–Ω—Å–æ—Ä–æ–≤, —Å–≤—è–∑–∞–Ω–Ω—ã—Ö —Å –º—ã—à—å—é
        }
        
        // –û–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–∞–∂–∞—Ç–∏–π –∫–ª–∞–≤–∏—à
        function handleKeyDown(e) {
            // –î–ª—è –±–ª–æ–∫–æ–≤ "–ö–æ–≥–¥–∞ –Ω–∞–∂–∞—Ç–∞ –∫–ª–∞–≤–∏—à–∞"
            const keyBlocks = document.querySelectorAll('.code-line[data-type="when-key"]');
            keyBlocks.forEach(block => {
                const keyInput = block.querySelector('.block-input');
                if (keyInput && keyInput.value.toLowerCase() === e.key.toLowerCase()) {
                    executeBlock(block);
                }
            });
            
            // –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ WASD
            if (document.querySelector('.code-line[data-type="wasd-controls"]')) {
                switch(e.key.toLowerCase()) {
                    case 'w':
                        moveTurtle(10);
                        break;
                    case 'a':
                        turnTurtle(15);
                        break;
                    case 's':
                        moveTurtle(-10);
                        break;
                    case 'd':
                        turnTurtle(-15);
                        break;
                }
            }
        }
        
        function handleKeyUp(e) {
            // –ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É –æ—Ç–ø—É—Å–∫–∞–Ω–∏—è –∫–ª–∞–≤–∏—à
        }
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        window.onload = init;
    </script>
</body>
</html>
